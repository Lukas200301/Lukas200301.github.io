<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Secure Password Generator - Generate cryptographically secure passwords with customizable options">
    <meta name="keywords" content="password generator, secure passwords, cryptography, random, security, tools">
    <meta name="author" content="Lukas200301">
    <meta property="og:title" content="Secure Password Generator - Lukas200301">
    <meta property="og:description" content="Generate cryptographically secure passwords with customizable length and character sets">
    <meta property="og:image" content="https://github.com/Lukas200301.png">
    <meta property="og:url" content="https://lukas200301.github.io/tools/pwgenerator">
    <title>Secure Password Generator | Lukas200301</title>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="../tools-styles.css">
    <link rel="stylesheet" href="pwgenerator-styles.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://github.com/Lukas200301.png">
</head>
<body>
    <!-- Cursor Follower -->
    <div class="cursor-follower" id="cursorFollower"></div>
    <div class="cursor-dot" id="cursorDot"></div>

    <!-- Neural Network Background -->
    <div class="neural-network" id="neuralNetwork">
        <canvas id="neuralCanvas"></canvas>
    </div>

    <!-- Floating Elements -->
    <div class="floating-elements">
        <!-- Elements will be generated by floating-elements.js -->
    </div>

    <!-- Main Content -->
    <main class="tool-page-no-nav">
        <!-- Header Section -->
        <section id="overview" class="tool-hero">
            <div class="section-container">
                <div class="tool-header">
                    <div class="tool-info">
                        <div class="tool-breadcrumb">
                            <a href="../../index.html" class="breadcrumb-link">
                                <i class="fas fa-home"></i>
                                <span>Home</span>
                            </a>
                            <span class="breadcrumb-separator">/</span>
                            <a href="../index.html" class="breadcrumb-link">
                                <i class="fas fa-tools"></i>
                                <span>Tools</span>
                            </a>
                            <span class="breadcrumb-separator">/</span>
                            <span class="breadcrumb-current">Password Generator</span>
                        </div>
                        
                        <h1 class="tool-title">
                            <i class="fas fa-shield-alt"></i>
                            Secure Password Generator
                        </h1>
                        <p class="tool-description">
                            Generate cryptographically secure passwords with customizable length, character sets, and patterns. 
                            Built with Web Crypto API for maximum security and randomness.
                        </p>
                        <div class="tool-meta">
                            <div class="meta-item">
                                <i class="fas fa-lock"></i>
                                <span>Client-side Security</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-random"></i>
                                <span>Cryptographically Secure</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-cog"></i>
                                <span>Highly Customizable</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Password Generator Section -->
        <section id="generator" class="tool-section">
            <div class="section-container">
                <div class="generator-container">
                    <!-- Password Output -->
                    <div class="password-output-section">
                        <div class="section-title">
                            <i class="fas fa-key"></i>
                            Generated Password
                        </div>
                        <div class="password-display">
                            <div class="password-field">
                                <textarea id="passwordOutput" readonly placeholder="Click generate to create a password"></textarea>
                                <div class="password-actions">
                                    <button id="copyPassword" class="action-btn" title="Copy to clipboard">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button id="refreshPassword" class="action-btn" title="Generate new password">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="password-strength">
                                <div class="strength-bar">
                                    <div class="strength-fill" id="strengthFill"></div>
                                </div>
                                <span class="strength-text" id="strengthText">Click generate to see strength</span>
                            </div>
                            
                            <div class="crack-time">
                                <div class="crack-time-label">
                                    <i class="fas fa-clock"></i>
                                    Time to crack:
                                </div>
                                <span class="crack-time-text" id="crackTimeText">Generate password to see estimate</span>
                            </div>
                        </div>
                    </div>

                    <!-- Configuration Panel -->
                    <div class="config-panel">
                        <div class="config-section">
                            <div class="section-title">
                                <i class="fas fa-sliders-h"></i>
                                Password Configuration
                            </div>
                            
                            <!-- Length Configuration -->
                            <div class="config-group">
                                <label for="passwordLength">Password Length</label>
                                <div class="length-control">
                                    <input type="range" id="passwordLength" min="4" max="128" value="16" class="slider">
                                    <span class="length-value" id="lengthValue">16</span>
                                </div>
                            </div>

                            <!-- Character Sets -->
                            <div class="config-group">
                                <label>Character Sets</label>
                                <div class="charset-options">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="includeUppercase" checked>
                                        <label for="includeUppercase">
                                            <i class="fas fa-font"></i>
                                            Uppercase Letters (A-Z)
                                        </label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="includeLowercase" checked>
                                        <label for="includeLowercase">
                                            <i class="fas fa-font"></i>
                                            Lowercase Letters (a-z)
                                        </label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="includeNumbers" checked>
                                        <label for="includeNumbers">
                                            <i class="fas fa-hashtag"></i>
                                            Numbers (0-9)
                                        </label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="includeSymbols" checked>
                                        <label for="includeSymbols">
                                            <i class="fas fa-asterisk"></i>
                                            Symbols (!@#$%^&*)
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Advanced Options -->
                            <div class="config-group">
                                <label>Advanced Options</label>
                                <div class="advanced-options">
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="excludeSimilar">
                                        <label for="excludeSimilar">
                                            <i class="fas fa-eye-slash"></i>
                                            Exclude Similar Characters (0, O, l, I)
                                        </label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="excludeAmbiguous" checked>
                                        <label for="excludeAmbiguous">
                                            <i class="fas fa-question-circle"></i>
                                            Exclude Ambiguous Characters ({ } [ ] ( ) / \ ' " ` ~ , ; . < >)
                                        </label>
                                    </div>
                                    <div class="checkbox-item">
                                        <input type="checkbox" id="requireEachType">
                                        <label for="requireEachType">
                                            <i class="fas fa-check-double"></i>
                                            Require at least one character from each selected set
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Custom Character Set -->
                            <div class="config-group">
                                <label for="customCharset">Custom Character Set (Optional)</label>
                                <textarea id="customCharset" placeholder="Enter custom characters to use instead of standard sets"></textarea>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </section>


    </main>

    <!-- Section Navigation Dots -->
    <div class="section-nav-dots" id="sectionNavDots">
        <div class="nav-dot active" data-section="overview" title="Overview">
            <span class="dot-label">Overview</span>
        </div>
        <div class="nav-dot" data-section="generator" title="Generator">
            <span class="dot-label">Generator</span>
        </div>
    </div>

    <!-- Back to Top -->
    <button class="back-to-top" id="backToTop" aria-label="Back to top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <!-- Scripts -->
    <script src="../../js/floating-elements.js"></script>
    <script src="../../js/script.js"></script>
    <script>
        class SecurePasswordGenerator {
            constructor() {
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateLengthDisplay();
                this.generatePassword(); // Generate initial password
            }

            setupEventListeners() {
                // Length slider
                document.getElementById('passwordLength').addEventListener('input', () => {
                    this.updateLengthDisplay();
                    if (document.getElementById('passwordOutput').value) {
                        this.generatePassword();
                    }
                });

                // Character set checkboxes
                const checkboxes = ['includeUppercase', 'includeLowercase', 'includeNumbers', 'includeSymbols'];
                checkboxes.forEach(id => {
                    document.getElementById(id).addEventListener('change', () => {
                        if (document.getElementById('passwordOutput').value) {
                            this.generatePassword();
                        }
                    });
                });

                // Advanced options
                const advancedOptions = ['excludeSimilar', 'excludeAmbiguous', 'requireEachType'];
                advancedOptions.forEach(id => {
                    document.getElementById(id).addEventListener('change', () => {
                        if (document.getElementById('passwordOutput').value) {
                            this.generatePassword();
                        }
                    });
                });

                // Custom charset
                document.getElementById('customCharset').addEventListener('input', () => {
                    if (document.getElementById('passwordOutput').value) {
                        this.generatePassword();
                    }
                });

                // Buttons
                document.getElementById('refreshPassword').addEventListener('click', () => this.generatePassword());
                document.getElementById('copyPassword').addEventListener('click', () => this.copyToClipboard());
            }

            updateLengthDisplay() {
                const length = document.getElementById('passwordLength').value;
                document.getElementById('lengthValue').textContent = length;
            }

            getCharacterSet() {
                const customCharset = document.getElementById('customCharset').value.trim();
                if (customCharset) {
                    return customCharset;
                }

                let charset = '';
                const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                const lowercase = 'abcdefghijklmnopqrstuvwxyz';
                const numbers = '0123456789';
                const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';

                if (document.getElementById('includeUppercase').checked) charset += uppercase;
                if (document.getElementById('includeLowercase').checked) charset += lowercase;
                if (document.getElementById('includeNumbers').checked) charset += numbers;
                if (document.getElementById('includeSymbols').checked) charset += symbols;

                if (!charset) {
                    alert('Please select at least one character set or provide a custom character set.');
                    return '';
                }

                // Apply exclusions
                if (document.getElementById('excludeSimilar').checked) {
                    charset = charset.replace(/[0Ol1]/g, '');
                }

                if (document.getElementById('excludeAmbiguous').checked) {
                    charset = charset.replace(/[{}[\]()\/\\'"`,;.<>]/g, '');
                }

                return charset;
            }

            generateSecureRandom(max) {
                const array = new Uint32Array(1);
                crypto.getRandomValues(array);
                return array[0] % max;
            }

            generatePassword() {
                const length = parseInt(document.getElementById('passwordLength').value);
                const charset = this.getCharacterSet();
                
                if (!charset) return;

                let password = '';
                const requireEachType = document.getElementById('requireEachType').checked;
                const customCharset = document.getElementById('customCharset').value.trim();

                if (requireEachType && !customCharset) {
                    // Ensure at least one character from each selected type
                    const types = [];
                    if (document.getElementById('includeUppercase').checked) types.push('ABCDEFGHIJKLMNOPQRSTUVWXYZ');
                    if (document.getElementById('includeLowercase').checked) types.push('abcdefghijklmnopqrstuvwxyz');
                    if (document.getElementById('includeNumbers').checked) types.push('0123456789');
                    if (document.getElementById('includeSymbols').checked) types.push('!@#$%^&*()_+-=[]{}|;:,.<>?');

                    // Apply exclusions to types
                    if (document.getElementById('excludeSimilar').checked) {
                        types.forEach((type, index) => {
                            types[index] = type.replace(/[0Ol1]/g, '');
                        });
                    }
                    if (document.getElementById('excludeAmbiguous').checked) {
                        types.forEach((type, index) => {
                            types[index] = type.replace(/[{}[\]()\/\\'"`,;.<>]/g, '');
                        });
                    }

                    // Add one character from each type
                    types.forEach(type => {
                        if (type && password.length < length) {
                            const randomIndex = this.generateSecureRandom(type.length);
                            password += type[randomIndex];
                        }
                    });

                    // Fill remaining length with random characters from full charset
                    while (password.length < length) {
                        const randomIndex = this.generateSecureRandom(charset.length);
                        password += charset[randomIndex];
                    }

                    // Shuffle the password to avoid predictable patterns
                    password = this.shuffleString(password);
                } else {
                    // Standard generation
                    for (let i = 0; i < length; i++) {
                        const randomIndex = this.generateSecureRandom(charset.length);
                        password += charset[randomIndex];
                    }
                }

                document.getElementById('passwordOutput').value = password;
                this.updatePasswordStrength(password);
                this.updateCrackTime(password);
            }

            shuffleString(str) {
                const array = str.split('');
                for (let i = array.length - 1; i > 0; i--) {
                    const j = this.generateSecureRandom(i + 1);
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array.join('');
            }

            calculateEntropy(password) {
                const charset = this.getCharacterSet();
                if (!charset) return 0;
                
                const charsetSize = new Set(charset).size;
                return password.length * Math.log2(charsetSize);
            }

            updatePasswordStrength(password) {
                const entropy = this.calculateEntropy(password);
                const strengthFill = document.getElementById('strengthFill');
                const strengthText = document.getElementById('strengthText');

                let strength, color, percentage;

                if (entropy < 30) {
                    strength = 'Very Weak';
                    color = '#ef4444';
                    percentage = 20;
                } else if (entropy < 50) {
                    strength = 'Weak';
                    color = '#f97316';
                    percentage = 40;
                } else if (entropy < 70) {
                    strength = 'Fair';
                    color = '#eab308';
                    percentage = 60;
                } else if (entropy < 90) {
                    strength = 'Strong';
                    color = '#22c55e';
                    percentage = 80;
                } else {
                    strength = 'Very Strong';
                    color = '#16a34a';
                    percentage = 100;
                }

                strengthFill.style.width = `${percentage}%`;
                strengthFill.style.background = color;
                strengthText.textContent = `${strength} (${Math.round(entropy)} bits of entropy)`;
                strengthText.style.color = color;
            }

            updateCrackTime(password) {
                const entropy = this.calculateEntropy(password);
                const crackTimeText = document.getElementById('crackTimeText');
                
                // Assumptions for calculation:
                // - Modern GPU can try ~100 billion passwords per second
                // - Average time = (total possibilities / 2) / attempts per second
                const attemptsPerSecond = 100000000000; // 100 billion attempts/second
                const totalPossibilities = Math.pow(2, entropy);
                const averageSeconds = totalPossibilities / 2 / attemptsPerSecond;
                
                const timeString = this.formatTime(averageSeconds);
                crackTimeText.textContent = timeString;
                
                // Color code based on time to crack
                if (averageSeconds < 60) { // Less than 1 minute
                    crackTimeText.style.color = '#ef4444';
                } else if (averageSeconds < 3600) { // Less than 1 hour
                    crackTimeText.style.color = '#f97316';
                } else if (averageSeconds < 86400) { // Less than 1 day
                    crackTimeText.style.color = '#eab308';
                } else if (averageSeconds < 31536000) { // Less than 1 year
                    crackTimeText.style.color = '#22c55e';
                } else {
                    crackTimeText.style.color = '#16a34a';
                }
            }

            formatTime(seconds) {
                if (seconds < 1) {
                    return 'Instantly';
                } else if (seconds < 60) {
                    return `${Math.round(seconds)} seconds`;
                } else if (seconds < 3600) {
                    const minutes = Math.round(seconds / 60);
                    return `${minutes} minute${minutes !== 1 ? 's' : ''}`;
                } else if (seconds < 86400) {
                    const hours = Math.round(seconds / 3600);
                    return `${hours} hour${hours !== 1 ? 's' : ''}`;
                } else if (seconds < 31536000) {
                    const days = Math.round(seconds / 86400);
                    return `${days} day${days !== 1 ? 's' : ''}`;
                } else if (seconds < 31536000000) {
                    const years = Math.round(seconds / 31536000);
                    return `${years.toLocaleString()} year${years !== 1 ? 's' : ''}`;
                } else if (seconds < 31536000000000) {
                    const thousands = Math.round(seconds / 31536000000);
                    return `${thousands.toLocaleString()} thousand years`;
                } else if (seconds < 31536000000000000) {
                    const millions = Math.round(seconds / 31536000000000);
                    return `${millions.toLocaleString()} million years`;
                } else if (seconds < 31536000000000000000) {
                    const billions = Math.round(seconds / 31536000000000000);
                    return `${billions.toLocaleString()} billion years`;
                } else {
                    return 'More than the age of the universe';
                }
            }

            async copyToClipboard() {
                const password = document.getElementById('passwordOutput').value;
                if (!password) {
                    alert('No password to copy!');
                    return;
                }

                try {
                    await navigator.clipboard.writeText(password);
                    const button = document.getElementById('copyPassword');
                    const icon = button.querySelector('i');
                    
                    // Visual feedback
                    icon.className = 'fas fa-check';
                    button.style.color = 'var(--success-accent)';
                    
                    setTimeout(() => {
                        icon.className = 'fas fa-copy';
                        button.style.color = '';
                    }, 2000);
                } catch (err) {
                    // Fallback for older browsers
                    const textArea = document.createElement('textarea');
                    textArea.value = password;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    
                    alert('Password copied to clipboard!');
                }
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new SecurePasswordGenerator();
        });
    </script>
</body>
</html>
